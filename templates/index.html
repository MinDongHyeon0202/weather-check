<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ê±´ì„¤ ê³µì • íŒë‹¨ ì‹œìŠ¤í…œ</title>
    {% if location %}
<p>ğŸ“ í˜„ì¬ ìœ„ì¹˜: <strong>{{ location }}</strong></p>
    {% if lat and lon %}
<h3>ğŸ—ºï¸ ë‚´ ìœ„ì¹˜ ì§€ë„</h3>
<img src="https://maps.googleapis.com/maps/api/staticmap?center={{ lat }},{{ lon }}&zoom=13&size=600x300&markers=color:red%7Clabel:A%7C{{ lat }},{{ lon }}&key=AIzaSyDs_I-NsX3VV_mehgJ1xAytxc_H1J2JjhM" alt="ì§€ë„">
{% endif %}
{% endif %}
    <!-- ìƒëµ: ìŠ¤íƒ€ì¼ -->
</head>
<body>
    <div class="container">
        <h1>ê±´ì„¤ ê³µì • íŒë‹¨ ì‹œìŠ¤í…œ ğŸŒ¦ï¸</h1>
<form method="POST">
  <label for="task">ê³µì •ì„ ì„ íƒí•˜ì„¸ìš”:</label>
  <select name="task" id="task" required>
      {% for t in tasks %}
          <option value="{{ t }}" {% if selected_task == t %}selected{% endif %}>{{ t }}</option>
      {% endfor %}
  </select>

  <input type="hidden" name="lat" id="lat">
  <input type="hidden" name="lon" id="lon">

  <button type="submit">íŒë‹¨í•˜ê¸°</button>
</form>

<!-- âœ… ìœ„ì¹˜ í™•ì¸ìš© ìœ„ê²½ë„ ì¶œë ¥ -->
{% if lat and lon %}
<p>
  ğŸ“ í˜„ì¬ ìœ„ë„: <strong>{{ lat }}</strong><br>
  ğŸ“ í˜„ì¬ ê²½ë„: <strong>{{ lon }}</strong>
</p>

<h3>ğŸ—ºï¸ í˜„ì¬ ìœ„ì¹˜ ì§€ë„</h3>
<img src="https://staticmap.openstreetmap.de/staticmap.php?center={{ lat }},{{ lon }}&zoom=13&size=600x300&markers={{ lat }},{{ lon }},red-pushpin" alt="ì§€ë„">
{% endif %}

<!-- âœ… GPS ì¶”ì¶œ ìŠ¤í¬ë¦½íŠ¸ -->
<script>
navigator.geolocation.getCurrentPosition(function(position) {
  document.getElementById('lat').value = position.coords.latitude;
  document.getElementById('lon').value = position.coords.longitude;
}, function(error) {
  console.warn('ìœ„ì¹˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤:', error.message);
});
</script>
</body>
</html>
