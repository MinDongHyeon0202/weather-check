<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ê±´ì„¤ ê³µì • íŒë‹¨ ì‹œìŠ¤í…œ</title>
    {% if location %}
<p>ğŸ“ í˜„ì¬ ìœ„ì¹˜: <strong>{{ location }}</strong></p>
    {% if lat and lon %}
<h3>ğŸ—ºï¸ ë‚´ ìœ„ì¹˜ ì§€ë„</h3>
<img src="https://maps.googleapis.com/maps/api/staticmap?center={{ lat }},{{ lon }}&zoom=13&size=600x300&markers=color:red%7Clabel:A%7C{{ lat }},{{ lon }}&key=AIzaSyDs_I-NsX3VV_mehgJ1xAytxc_H1J2JjhM" alt="ì§€ë„">
{% endif %}
{% endif %}
    <!-- ìƒëµ: ìŠ¤íƒ€ì¼ -->
</head>
<body>
    <div class="container">
        <h1>ê±´ì„¤ ê³µì • íŒë‹¨ ì‹œìŠ¤í…œ ğŸŒ¦ï¸</h1>
        <form method="POST">
            <select name="task">
                {% for t in tasks %}
                    <option value="{{ t }}">{{ t }}</option>
                {% endfor %}
            </select>
            <input type="hidden" name="lat" id="lat">
            <input type="hidden" name="lon" id="lon">
            <button type="submit">íŒë‹¨í•˜ê¸°</button>
        </form>
        {% if weather %}
            <p>í˜„ì¬ ê¸°ì˜¨: {{ weather.temp }}â„ƒ</p>
        {% endif %}
        {% if result %}
            <p>ğŸ“‹ íŒë‹¨ ê²°ê³¼: {{ result }}</p>
        {% endif %}
        {% if forecast %}
<h3>ğŸ“† 24ì‹œê°„ ì˜ˆë³´ ì‘ì—… ê°€ëŠ¥ì„±</h3>
<table border="1" cellpadding="6" cellspacing="0">
  <tr>
    <th>ì‹œê°„</th>
    <th>ê¸°ì˜¨(â„ƒ)</th>
    <th>ìŠµë„(%)</th>
    <th>í’ì†(m/s)</th>
    <th>ê°•ìˆ˜(mm)</th>
    <th>íŒë‹¨</th>
  </tr>
  {% for f in forecast %}
  <tr>
    <td>{{ f.time }}</td>
    <td>{{ f.temp }}</td>
    <td>{{ f.humidity }}</td>
    <td>{{ f.wind }}</td>
    <td>{{ f.rain }}</td>
    <td>{{ f.judgment }}</td>
  </tr>
  {% endfor %}
</table>
{% endif %}
{% if schedule %}
<h3>ğŸ“Œ ì‹œê°„ëŒ€ë³„ ì‘ì—… ì¶”ì²œ ìŠ¤ì¼€ì¤„</h3>
<table border="1" cellpadding="6">
  <tr>
    <th>ì‹œê°„</th>
    <th>ê°€ëŠ¥í•œ ì‘ì—… ê³µì •</th>
  </tr>
  {% for time, task_list in schedule.items() %}
  <tr>
    <td>{{ time }}</td>
    <td>
      {% if task_list %}
        {{ task_list|join(', ') }}
      {% else %}
        ì—†ìŒ
      {% endif %}
    </td>
  </tr>
  {% endfor %}
</table>
{% endif %}

    </div>
    <script>
navigator.geolocation.getCurrentPosition(function(position) {
  document.getElementById('lat').value = position.coords.latitude;
  document.getElementById('lon').value = position.coords.longitude;
}, function(error) {
  console.warn('ìœ„ì¹˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤:', error.message);
});
</script>
</body>
</html>
